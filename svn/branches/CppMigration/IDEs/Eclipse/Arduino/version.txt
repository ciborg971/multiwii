Sources taken from Arduino IDE 1.0.5